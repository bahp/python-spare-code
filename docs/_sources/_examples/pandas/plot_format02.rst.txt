
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_examples\pandas\plot_format02.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__examples_pandas_plot_format02.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__examples_pandas_plot_format02.py:


02. Aggregation
======================

Aggregate patient's data in a single row.

.. GENERATED FROM PYTHON SOURCE LINES 7-116




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

        1/  300. Patient '0'
       11/  300. Patient '10'
       21/  300. Patient '20'
       31/  300. Patient '30'
       41/  300. Patient '40'
       51/  300. Patient '50'
       61/  300. Patient '60'
       71/  300. Patient '70'
       81/  300. Patient '80'
       91/  300. Patient '90'
      101/  300. Patient '100'
                  0         1         2         3         4         5         6         7         8    ...        92         93         94         95         96         97         98         99          100
    max_f_0  0.997045  0.997329  0.998343  0.999169  0.997662  0.998819  0.996182  0.996803  0.998356  ...   0.994359   0.990321   0.999116   0.999010   0.998482   0.999037   0.999540   0.996819    0.999639
    max_f_1  0.999186  0.997964  0.996899  0.998303  0.998741  0.996704  0.998057  0.998318  0.995990  ...   0.994466   0.997651   0.999697   0.998053   0.999352   0.999710   0.997571   0.998847    0.998949
    max_f_2  0.997796  0.999760  0.997425  0.996096  0.994325  0.998040  0.997270  0.999379  0.998065  ...   0.999903   0.995295   0.999384   0.998750   0.999925   0.999826   0.998145   0.999686    0.999364
    max_f_3  0.996439  0.999584  0.999384  0.995153  0.999555  0.994770  0.999458  0.999305  0.998832  ...   0.999881   0.998207   0.995933   0.999123   0.999755   0.999882   0.998722   0.995947    0.999872
    max_f_4  0.999969  0.999548  0.998289  0.999188  0.996390  0.998556  0.996746  0.992795  0.998838  ...   0.998924   0.999877   0.998605   0.999264   0.996037   0.994919   0.999023   0.998884    0.997340
    max_f_5  0.991851  0.995156  0.998570  0.999517  0.999525  0.999479  0.999508  0.997347  0.998315  ...   0.998200   0.999480   0.999301   0.999286   0.999600   0.997000   0.999914   0.999754    0.999354
    max_f_6  0.994875  0.998866  0.998797  0.998384  0.990748  0.997464  0.999418  0.999076  0.998338  ...   0.992614   0.998253   0.998074   0.999432   0.997190   0.998933   0.995645   0.998974    0.999055
    max_f_7  0.997934  0.998368  0.995027  0.999867  0.997710  0.998287  0.999716  0.997251  0.999847  ...   0.995371   0.998086   0.997959   0.999314   0.998645   0.997880   0.999272   0.998420    0.999772
    max_f_8  0.994599  0.996667  0.998585  0.996297  0.995787  0.999954  0.997770  0.998141  0.998535  ...   0.998373   0.997233   0.996740   0.997568   0.997872   0.999051   0.987723   0.998123    0.996372
    max_f_9  0.996681  0.996653  0.997264  0.999973  0.997879  0.998621  0.999343  0.995310  0.998436  ...   0.998664   0.994320   0.998496   0.999698   0.999864   0.999643   0.998609   0.994934    0.999462
    max_id   0.000000  1.000000  2.000000  3.000000  4.000000  5.000000  6.000000  7.000000  8.000000  ...  92.000000  93.000000  94.000000  95.000000  96.000000  97.000000  98.000000  99.000000  100.000000
    min_f_0  0.000896  0.000852  0.003812  0.000044  0.000300  0.001021  0.005146  0.001482  0.000322  ...   0.001424   0.000854   0.002622   0.006622   0.001294   0.004518   0.000786   0.000831    0.000182
    min_f_1  0.001539  0.001650  0.001146  0.001007  0.000146  0.000732  0.000869  0.000183  0.000979  ...   0.003183   0.002853   0.000523   0.000739   0.007262   0.001424   0.002460   0.003140    0.000997
    min_f_2  0.000467  0.000930  0.002310  0.000130  0.000627  0.000477  0.004982  0.000501  0.000832  ...   0.001200   0.006269   0.004463   0.001463   0.000233   0.000677   0.001255   0.004577    0.006294
    min_f_3  0.000761  0.003199  0.001525  0.000631  0.000362  0.000082  0.008072  0.001152  0.000889  ...   0.005252   0.000705   0.002591   0.004259   0.001162   0.001681   0.000079   0.000352    0.002085
    min_f_4  0.000874  0.000588  0.003081  0.000011  0.001172  0.000867  0.010538  0.000505  0.000102  ...   0.001154   0.001179   0.001715   0.002879   0.002471   0.000494   0.000551   0.003861    0.000044
    min_f_5  0.003833  0.000806  0.000499  0.004029  0.000282  0.001938  0.001034  0.000741  0.003264  ...   0.001855   0.001282   0.005734   0.004157   0.001200   0.001434   0.000023   0.002062    0.000466
    min_f_6  0.000682  0.002965  0.003973  0.001146  0.001827  0.000783  0.000084  0.000436  0.000036  ...   0.002837   0.000104   0.002493   0.004882   0.001455   0.001537   0.000382   0.003949    0.001150
    min_f_7  0.000436  0.000143  0.000509  0.001966  0.001894  0.000626  0.000034  0.001591  0.003000  ...   0.000758   0.005984   0.000992   0.001231   0.008124   0.001557   0.002761   0.001145    0.000546
    min_f_8  0.001024  0.000014  0.001901  0.000057  0.002886  0.001874  0.009184  0.000071  0.004549  ...   0.000947   0.002274   0.000925   0.000215   0.001125   0.004230   0.002212   0.006846    0.000412
    min_f_9  0.000581  0.000650  0.000616  0.000184  0.008068  0.000667  0.001763  0.000068  0.002692  ...   0.007735   0.002827   0.001732   0.000056   0.000724   0.011357   0.001293   0.000587    0.003021
    min_id   0.000000  1.000000  2.000000  3.000000  4.000000  5.000000  6.000000  7.000000  8.000000  ...  92.000000  93.000000  94.000000  95.000000  96.000000  97.000000  98.000000  99.000000  100.000000
    id       0.000000  1.000000  2.000000  3.000000  4.000000  5.000000  6.000000  7.000000  8.000000  ...  92.000000  93.000000  94.000000  95.000000  96.000000  97.000000  98.000000  99.000000  100.000000

    [23 rows x 101 columns]






|

.. code-block:: default
   :lineno-start: 8


    # Generic
    import warnings
    import numpy as np
    import pandas as pd 

    # Ignore warnings
    warnings.simplefilter("ignore")

    def load_data():
    	return pd.read_csv('./laboratory.csv', parse_dates=['date'])

    def create_data():
    	""""""
    	# Configuration
    	ROWS, COLS = 150000, 10
    	PATIENTS = 300

    	# Create random values
    	features = np.random.random_sample((ROWS, COLS))
    	patients = np.random.randint(PATIENTS, size=(ROWS, 1))

    	# Create DataFrame
    	df = pd.DataFrame(data=features)
    	df = df.add_prefix('f_')
    	df['id'] = patients

    	# Return
    	return df


    # -----------------------
    # Read data
    # -----------------------
    # Read data
    #data = pd.read_csv('./laboratory.csv', parse_dates=['date'])

    data = create_data()


    # -----------------------
    # Format
    # -----------------------
    # Configuration
    show_progress_every = 10 # Number of patients
    break_loop_after = 100  # Number of patients or None

    # Create empty outcome
    results = pd.DataFrame()

    # Groups
    groups = data.groupby(by='id')

    # Step by step (16270 groups!)
    for i, (k, g) in enumerate(groups):
    	# Show information
    	if (i % show_progress_every) == 0:
    		print("%5s/%5s. Patient '%s'" % (i+1, len(groups), k))

    	# Show dataframe
    	#print(g)

    	# Sort by dates (if needed)

    	# Fill empty values
    	#g.fillna(method='backfill', inplace=True)

    	# Compute statistics
    	# ------------------
    	# .. note: Forward/backward filling does not affect
    	#          the max/min but it affects the mean or
    	#          median.
    	#
    	# .. note: You could also create a map with all the 
    	#          functions you want to apply instead of 
    	#          using describe. This is useful if you need 
    	#          specific stats

    	# Get the common stats
    	#d = g.describe()

    	# Get specific stats for all columns	
    	d = g.agg({c: ['max', 'min'] for c in g.columns})

    	# Stack the describe outcome 
    	d = d.stack()
    	d.index = ['_'.join(e) for e in d.index.tolist()]
    	d['id'] = k                  # patient identifier
    	#d['date'] = min(g['date'])   # admission date

    	# Append result
    	results = pd.concat([results, d], ignore_index=True, axis=1)

    	# Break clause for testing
    	#if break_loop_after is not None:
    	if i==break_loop_after:
    		break


    # Show columns
    #print(results.columns.values)

    print(results)

    # Show results (partially)
    #print(results[['id', 'date', 'max_wcc']])

    # .. note: Once it works as you want, you can try to do it
    #          in one single line and compare the results to 
    #          verify that it is correct.

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.843 seconds)


.. _sphx_glr_download__examples_pandas_plot_format02.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_format02.py <plot_format02.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_format02.ipynb <plot_format02.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
