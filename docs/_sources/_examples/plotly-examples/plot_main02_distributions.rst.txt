
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_examples/plotly-examples/plot_main02_distributions.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__examples_plotly-examples_plot_main02_distributions.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__examples_plotly-examples_plot_main02_distributions.py:


Plot Distributions
======================

This example shows how to plot the probability distributions
for each of the components of the confusion matrix. Note that
data is created artificially. If necessary, it is possible
to limit the axis to the range [0, 1] to keep only those true
probability values.

.. GENERATED FROM PYTHON SOURCE LINES 11-144





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script src="https://cdn.plot.ly/plotly-2.1.0.min.js"></script>                <div id="43893ff5-5895-4c5b-8c42-c4e7725589b6" class="plotly-graph-div" style="height:350px; width:700px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("43893ff5-5895-4c5b-8c42-c4e7725589b6")) {                    Plotly.newPlot(                        "43893ff5-5895-4c5b-8c42-c4e7725589b6",                        [{"box":{"visible":true},"fillcolor":"#6ece58","line":{"color":"black","width":1},"meanline":{"visible":true},"name":"tn","opacity":0.5,"type":"violin","x":[-0.9369938064445821,-0.4145338394535447,0.21063803014751276,-0.6433617299979716,-0.9108202736368599,-0.8309618159580457,-0.06964284348851606,1.1800102521839877,1.325964308573805,0.624749702646505,-1.2677523398519226,-0.5332643995604655,-0.10560053314448267,-0.611265815483663,0.7614942023951209,-1.5811229789352503,-1.2731010784055294,-0.7268906950229791,-0.14345565666230153,0.9525345926978299,0.4763446292410868,0.9782546530669104],"xaxis":"x","yaxis":"y"},{"box":{"visible":true},"fillcolor":"#1f9e89","line":{"color":"black","width":1},"meanline":{"visible":true},"name":"fp","opacity":0.5,"type":"violin","x":[-0.5863419446760378,0.019987325697702698,0.1057372306318014,-0.9921693033038171,-0.3270768265259271,-1.642469229176727,-0.9657832094513464,0.9511729589169683,-0.5132294475931947,0.7232231926801891,0.639662526575159,-1.0044296839299085,0.5057196117548564,0.23864057995423663,-0.2820914289000494,0.144468976030242,1.9147968485519336,-1.2168579378332325,0.35728573583730305],"xaxis":"x2","yaxis":"y2"},{"box":{"visible":true},"fillcolor":"#31688e","line":{"color":"black","width":1},"meanline":{"visible":true},"name":"fn","opacity":0.5,"type":"violin","x":[-0.8476664907396858,1.0404050364965465,0.12467745531394936,-2.2590162347720497,-1.801838279318566,1.5333255212918437,-0.5595403976122827,0.07820890241398054,-0.2679792096328523,2.6159428512344043,1.004318984029543,1.340191703740537,2.005920776904149,0.837772341225653,0.21213698402832473,-0.24779724509176398,0.4556407345861043,-1.1645149461465847,0.5384023559729993,2.7126279014810075,1.6606288271721132,0.7485093852379512,-0.5824372398108936,-0.7538291099454687,-0.1619436975286356,-0.9562264801904944,0.8724472081577073,0.4969932729609259],"xaxis":"x3","yaxis":"y3"},{"box":{"visible":true},"fillcolor":"#fde725","line":{"color":"black","width":1},"meanline":{"visible":true},"name":"tp","opacity":0.5,"type":"violin","x":[-0.41730432479374097,0.35710233438959316,-0.9393976856064165,-0.2561425745657063,0.7244816342362294,-1.861293926575645,0.5386442687507871,0.23236854736150755,0.5941832728860587,-0.4889927432667185,-1.1194719581463204,-0.8668621013692376,-0.21775751538911478,1.250580180036362,-0.5567313426961014,0.8428182642690882,-0.8443754978794367,0.7475296013964668,-0.03752494413042829,-0.3322147558937821,0.6499409983664063,0.9976153309086886,-0.23712540594905535,2.049210403834323,-1.2069505375022127,0.16302870917438378,-1.598416749042795,-0.019583460015220405,0.677961790462857,0.2579878771551751,1.1904101753805607],"xaxis":"x4","yaxis":"y4"}],                        {"height":350,"margin":{"b":0,"l":0,"pad":0,"r":0,"t":0},"paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)","template":{"data":{"scatter":[{"type":"scatter"}]}},"width":700,"xaxis":{"anchor":"y","domain":[0.0,0.45]},"xaxis2":{"anchor":"y2","domain":[0.55,1.0]},"xaxis3":{"anchor":"y3","domain":[0.0,0.45]},"xaxis4":{"anchor":"y4","domain":[0.55,1.0]},"yaxis":{"anchor":"x","domain":[0.575,1.0],"visible":true},"yaxis2":{"anchor":"x2","domain":[0.575,1.0],"visible":true},"yaxis3":{"anchor":"x3","domain":[0.0,0.425],"visible":true},"yaxis4":{"anchor":"x4","domain":[0.0,0.425],"visible":true}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. code-block:: default
   :lineno-start: 12


    # Libraries
    import plotly.graph_objects as go
    from plotly.graph_objects import Layout
    import plotly.express as px
    import pandas as pd
    import numpy as np

    TERMINAL = False

    # -----------------------------------------
    # Helper method
    # -----------------------------------------
    # This method is implemented in pySML.
    def _tp_fp_tn_fn_distributions(y, y_pred, y_prob):
        """This function returns probabilities for each of the confusion
        matrix elements (tp, tn, fp, fn).

        Parameters
        ----------
        y : array-like
          The real categories

        y_pred : array-like
          The predicted categories

        y_prob: array-like
          The predict probabilities

        Returns
        -------
        tp_probs, tn_probs, fp_probs, fn_probs
        """
        # Tags.
        tp_idx = (y_pred == 1) & (y == 1)
        tn_idx = (y_pred == 0) & (y == 0)
        fp_idx = (y_pred == 1) & (y == 0)
        fn_idx = (y_pred == 0) & (y == 1)
        # Show information.
        tp_probs = y_prob[tp_idx]
        tn_probs = y_prob[tn_idx]
        fp_probs = y_prob[fp_idx]
        fn_probs = y_prob[fn_idx]
        # Return
        return tp_probs, tn_probs, fp_probs, fn_probs

    # -----------------------------------------
    # Config
    # -----------------------------------------
    # Colors
    colors = px.colors.qualitative.Plotly
    colors = px.colors.sequential.Plasma_r
    colors = px.colors.sequential.Viridis_r

    # -----------------------------------------
    # Data
    # -----------------------------------------
    # Create data
    data = pd.DataFrame()
    data['y_true'] = np.random.randint(2, size=100)
    data['y_pred'] = np.random.randint(2, size=100)
    data['y_prob'] = np.random.normal(loc=0, scale=1, size=100)

    # Get distributions
    tp_probs, tn_probs, fp_probs, fn_probs = \
        _tp_fp_tn_fn_distributions(data.y_true,
                                   data.y_pred,
                                   data.y_prob)

    # Visualize
    if TERMINAL:
        print("\nData:")
        print(data)


    # -------------------------------------
    # Visualize
    # -------------------------------------
    # Import subplots
    from plotly.subplots import make_subplots

    # Create figure
    fig = make_subplots(rows=2, cols=2)
    # subplot_titles=('TP', 'TN', 'FP', 'FN'))

    #  Add traces
    fig.add_trace(go.Violin(x=tn_probs, line_width=1,
        name='tn', line_color='black', fillcolor=colors[2],
        opacity=0.5, meanline_visible=True, box_visible=True), row=1, col=1)
    fig.add_trace(go.Violin(x=fp_probs, line_width=1,
        name='fp', line_color='black', fillcolor=colors[4],
        opacity=0.5, meanline_visible=True, box_visible=True), row=1, col=2)
    fig.add_trace(go.Violin(x=fn_probs, line_width=1,
        name='fn', line_color='black', fillcolor=colors[6],
        opacity=0.5, meanline_visible=True, box_visible=True), row=2, col=1)
    fig.add_trace(go.Violin(x=tp_probs, line_width=1,
        name='tp', line_color='black', fillcolor=colors[0],
        opacity=0.5, meanline_visible=True, box_visible=True), row=2, col=2)

    # Update layout
    fig.update_layout(
        width=700, height=350,
        #xaxis_title='False Positive Rate',
        #yaxis_title='True Positive Rate',
        #yaxis=dict(scaleanchor="x", scaleratio=1),
        #xaxis=dict(constrain='domain'),
        #legend=dict(
        #    x=1.0, y=0.0,  # x=1, y=1.02
        #    orientation="v",
        #    font={'size': 12},
        #    yanchor="bottom",
        #    xanchor="right",
        #),
        margin={
            'l': 0,
            'r': 0,
            'b': 0,
            't': 0,
            'pad': 0
        },
        paper_bgcolor='rgba(0,0,0,0)',  # transparent
        plot_bgcolor='rgba(0,0,0,0)'  # transparent
    )

    # Update axes
    #fig.update_xaxes(visible=True, range=[0.0, 0.5], row=1, col=1)
    #fig.update_xaxes(visible=True, range=[0.5, 1.0], row=1, col=2)
    #fig.update_xaxes(visible=True, range=[0.0, 0.5], row=2, col=1)
    #fig.update_xaxes(visible=True, range=[0.5, 1.0], row=2, col=2)
    fig.update_yaxes(visible=True)

    # Show
    #fig.show()
    fig

.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.234 seconds)


.. _sphx_glr_download__examples_plotly-examples_plot_main02_distributions.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_main02_distributions.py <plot_main02_distributions.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_main02_distributions.ipynb <plot_main02_distributions.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
