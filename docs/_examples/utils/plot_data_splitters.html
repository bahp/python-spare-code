<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data splitters &mdash; python-spare-code 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/eniapp.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Data Wrapper" href="plot_data_wrapper.html" />
    <link rel="prev" title="Test Skfold" href="plot_data_skfold_test.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> python-spare-code
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Example Galleries</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">General</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#clean-damien-sepsis">clean-damien-sepsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#clean-therapy-mimic">clean-therapy-mimic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#explainer-dashboard">Explainer Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#factory-boy">Factory Boy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#jsonpickle">jsonpickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#ldap">LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#matplotlib">Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#other">Other</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#pandas">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotly">Plotly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#scikits">Scikits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#shap">Shap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tableone">TableOne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#threshold-moving">Threshold Moving</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tpot">TPOT</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#utils">Utils</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_data_skfold_test.html">Test Skfold</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Data splitters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_wrapper.html">Data Wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_favicons.html">Plot favicons</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sklearn_iqr.html">IQRFilter</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">python-spare-code</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">General</a> &raquo;</li>
      <li>Data splitters</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/_examples/utils/plot_data_splitters.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-utils-plot-data-splitters-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="data-splitters">
<span id="sphx-glr-examples-utils-plot-data-splitters-py"></span><h1>Data splitters<a class="headerlink" href="#data-splitters" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>This example shows some methods to split the data.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not completed!</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 10</span> <span class="c1"># Libraries</span>
<span class="linenos"> 11</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="linenos"> 12</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span> <span class="c1"># Libraries specific</span>
<span class="linenos"> 15</span> <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="linenos"> 16</span> <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="linenos"> 17</span> <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span> <span class="k">def</span> <span class="nf">split_dataframe_hos_cvs</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 21</span>     <span class="sd">&quot;&quot;&quot;This method labels the dataframe hos and cvs sets.</span>
<span class="linenos"> 22</span>
<span class="linenos"> 23</span><span class="sd">     Parameters</span>
<span class="linenos"> 24</span><span class="sd">     ----------</span>
<span class="linenos"> 25</span><span class="sd">     dataframe: np.array or pd.DataFrame</span>
<span class="linenos"> 26</span><span class="sd">         The data to be divided into HOS/CVS.</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="sd">     Returns</span>
<span class="linenos"> 29</span><span class="sd">     -------</span>
<span class="linenos"> 30</span><span class="sd">     np.array:</span>
<span class="linenos"> 31</span><span class="sd">         The outcome is a numpy array with rows labelled as</span>
<span class="linenos"> 32</span><span class="sd">         cvs (cross-validation set) and hos (hold-out set).</span>
<span class="linenos"> 33</span><span class="sd">         :param data:</span>
<span class="linenos"> 34</span><span class="sd">         :param inplace:</span>
<span class="linenos"> 35</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos"> 36</span>     <span class="c1"># Check it is a dataframe</span>
<span class="linenos"> 37</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="linenos"> 38</span>         <span class="k">raise</span> <span class="ne">TypeError</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span>     <span class="c1"># Length</span>
<span class="linenos"> 41</span>     <span class="n">n</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>     <span class="c1"># Split in hos and training sets</span>
<span class="linenos"> 44</span>     <span class="n">cvs</span><span class="p">,</span> <span class="n">hos</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span>     <span class="c1"># Create result</span>
<span class="linenos"> 47</span>     <span class="n">empty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<span class="linenos"> 48</span>     <span class="n">empty</span><span class="p">[</span><span class="n">cvs</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cvs&#39;</span>
<span class="linenos"> 49</span>     <span class="n">empty</span><span class="p">[</span><span class="n">hos</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hos&#39;</span>
<span class="linenos"> 50</span>
<span class="linenos"> 51</span>     <span class="c1"># Include</span>
<span class="linenos"> 52</span>     <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;sets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">empty</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>     <span class="c1"># Return</span>
<span class="linenos"> 55</span>     <span class="k">return</span> <span class="n">dataframe</span>
<span class="linenos"> 56</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span> <span class="k">def</span> <span class="nf">split_dataframe_cvs_folds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span>
<span class="linenos"> 59</span>             <span class="n">selected_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 60</span>     <span class="sd">&quot;&quot;&quot;This method labels the different folds.</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span><span class="sd">         .. note:</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span><span class="sd">     Parameters</span>
<span class="linenos"> 65</span><span class="sd">     ----------</span>
<span class="linenos"> 66</span><span class="sd">     dataframe: np.array or pd.DataFrame</span>
<span class="linenos"> 67</span><span class="sd">         The data to be divided into folds.</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span><span class="sd">     splitter: str or splitter</span>
<span class="linenos"> 70</span><span class="sd">         The splitter which can be an str or an splitter from the</span>
<span class="linenos"> 71</span><span class="sd">         sklearn library which implementeds the method split.</span>
<span class="linenos"> 72</span>
<span class="linenos"> 73</span><span class="sd">     selected_rows: array of bools.</span>
<span class="linenos"> 74</span><span class="sd">         The rows to be considered to create the folds. Note that if</span>
<span class="linenos"> 75</span><span class="sd">         y is passed (for stratified cross validation) y will also be</span>
<span class="linenos"> 76</span><span class="sd">         filtered by these rows.</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="sd">     kwargs:</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="sd">     Returns</span>
<span class="linenos"> 81</span><span class="sd">     -------</span>
<span class="linenos"> 82</span><span class="sd">     pd.DataFrame:</span>
<span class="linenos"> 83</span><span class="sd">         The outcome is the same dataframe with an additional column</span>
<span class="linenos"> 84</span><span class="sd">         &lt;set&gt; with the values cvs (cross-validation set) and hos</span>
<span class="linenos"> 85</span><span class="sd">         (hold-out set).</span>
<span class="linenos"> 86</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos"> 87</span>     <span class="c1"># Check it is a dataframe</span>
<span class="linenos"> 88</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="linenos"> 89</span>         <span class="k">raise</span> <span class="ne">TypeError</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span>     <span class="c1"># Get splitter from string</span>
<span class="linenos"> 92</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="linenos"> 93</span>         <span class="n">splitter</span> <span class="o">=</span> <span class="n">_DEFAULT_SPLITTERS</span><span class="p">[</span><span class="n">splitter</span><span class="p">]</span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span>     <span class="c1"># Define X and y</span>
<span class="linenos"> 96</span>     <span class="c1">#X = dataframe[dataframe.sets == &#39;cvs&#39;].index.to_numpy()</span>
<span class="linenos"> 97</span>     <span class="c1">#y = dataframe[dataframe.sets == &#39;cvs&#39;][label]</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span>     <span class="c1"># Shape</span>
<span class="linenos">100</span>     <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span>
<span class="linenos">101</span>
<span class="linenos">102</span>     <span class="c1"># No rows selected (all by default)</span>
<span class="linenos">103</span>     <span class="k">if</span> <span class="n">selected_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">104</span>         <span class="n">selected_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="linenos">105</span>
<span class="linenos">106</span>     <span class="c1"># Select rows from y</span>
<span class="linenos">107</span>     <span class="k">if</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="linenos">108</span>         <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">109</span>             <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">selected_rows</span><span class="p">]</span>
<span class="linenos">110</span>
<span class="linenos">111</span>     <span class="c1"># Create indexes to use for splitting</span>
<span class="linenos">112</span>     <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">)[</span><span class="n">selected_rows</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">113</span>
<span class="linenos">114</span>     <span class="c1"># Get splits of idxs</span>
<span class="linenos">115</span>     <span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">116</span>
<span class="linenos">117</span>     <span class="c1"># Loop and add</span>
<span class="linenos">118</span>     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
<span class="linenos">119</span>         <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos">120</span>         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="n">train</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span>
<span class="linenos">121</span>         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="n">test</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span>
<span class="linenos">122</span>
<span class="linenos">123</span>     <span class="c1"># Return</span>
<span class="linenos">124</span>     <span class="k">return</span> <span class="n">dataframe</span>
<span class="linenos">125</span>
<span class="linenos">126</span>
<span class="linenos">127</span> <span class="k">def</span> <span class="nf">split_dataframe_completeness</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
<span class="linenos">128</span>     <span class="k">pass</span>
<span class="linenos">129</span>
<span class="linenos">130</span>
<span class="linenos">131</span>
<span class="linenos">132</span> <span class="k">class</span> <span class="nc">DataframeHOSCSVSplitter</span><span class="p">():</span>
<span class="linenos">133</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">134</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">135</span>     <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;sets&#39;</span>
<span class="linenos">136</span>     <span class="n">cvs_name</span> <span class="o">=</span> <span class="s1">&#39;CVS&#39;</span>
<span class="linenos">137</span>     <span class="n">hos_name</span> <span class="o">=</span> <span class="s1">&#39;HOS&#39;</span>
<span class="linenos">138</span>
<span class="linenos">139</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">140</span>                        <span class="n">cvs_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="linenos">141</span>                        <span class="n">hos_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos">142</span>         <span class="sd">&quot;&quot;&quot;Constructor</span>
<span class="linenos">143</span>
<span class="linenos">144</span><span class="sd">         :param col_name:</span>
<span class="linenos">145</span><span class="sd">         :param cvs_name:</span>
<span class="linenos">146</span><span class="sd">         :param hos_name:</span>
<span class="linenos">147</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="linenos">148</span>         <span class="k">if</span> <span class="n">col_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">149</span>             <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">col_name</span>
<span class="linenos">150</span>         <span class="k">if</span> <span class="n">cvs_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">151</span>             <span class="bp">self</span><span class="o">.</span><span class="n">cvs_name</span> <span class="o">=</span> <span class="n">cvs_name</span>
<span class="linenos">152</span>         <span class="k">if</span> <span class="n">hos_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">153</span>             <span class="bp">self</span><span class="o">.</span><span class="n">hos_name</span> <span class="o">=</span> <span class="n">hos_name</span>
<span class="linenos">154</span>
<span class="linenos">155</span>     <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos">156</span>         <span class="sd">&quot;&quot;&quot;Splits the dataframe...</span>
<span class="linenos">157</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="linenos">158</span>         <span class="c1"># Split</span>
<span class="linenos">159</span>         <span class="n">cvs</span><span class="p">,</span> <span class="n">hos</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="linenos">160</span>
<span class="linenos">161</span>         <span class="c1"># Fill dataset</span>
<span class="linenos">162</span>         <span class="n">dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos">163</span>         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cvs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cvs_name</span>
<span class="linenos">164</span>         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hos_name</span>
<span class="linenos">165</span>
<span class="linenos">166</span>         <span class="c1"># Return</span>
<span class="linenos">167</span>         <span class="k">return</span> <span class="n">dataframe</span>
<span class="linenos">168</span>
<span class="linenos">169</span>
<span class="linenos">170</span>
<span class="linenos">171</span> <span class="c1"># Default splliters.</span>
<span class="linenos">172</span> <span class="n">_DEFAULT_SPLITTERS</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">173</span>     <span class="s1">&#39;skfold10&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">174</span>     <span class="s1">&#39;skfold5&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">175</span>     <span class="s1">&#39;skfold2&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="linenos">176</span> <span class="p">}</span>
<span class="linenos">177</span>
<span class="linenos">178</span> <span class="n">TERMINAL</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">179</span>
<span class="linenos">180</span> <span class="c1"># --------------------------------------------------</span>
<span class="linenos">181</span> <span class="c1"># Main</span>
<span class="linenos">182</span> <span class="c1"># --------------------------------------------------</span>
<span class="linenos">183</span> <span class="c1"># Libraries</span>
<span class="linenos">184</span> <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="linenos">185</span>
<span class="linenos">186</span> <span class="c1"># Load data</span>
<span class="linenos">187</span> <span class="n">bunch</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">188</span>
<span class="linenos">189</span> <span class="c1"># Dataframe</span>
<span class="linenos">190</span> <span class="n">dataframe</span> <span class="o">=</span> <span class="n">bunch</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Lets see the dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">195</span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
<span class="linenos">196</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
<span class="linenos">197</span>     <span class="nb">print</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
<span class="linenos">198</span> <span class="n">dataframe</span>
<span class="linenos">199</span>
<span class="linenos">200</span> <span class="c1"># Split in HOS and CVS sets</span>
<span class="linenos">201</span> <span class="n">df</span> <span class="o">=</span> <span class="n">split_dataframe_hos_cvs</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)
0                  5.1               3.5                1.4               0.2
1                  4.9               3.0                1.4               0.2
2                  4.7               3.2                1.3               0.2
3                  4.6               3.1                1.5               0.2
4                  5.0               3.6                1.4               0.2
..                 ...               ...                ...               ...
145                6.7               3.0                5.2               2.3
146                6.3               2.5                5.0               1.9
147                6.5               3.0                5.2               2.0
148                6.2               3.4                5.4               2.3
149                5.9               3.0                5.1               1.8

[150 rows x 4 columns]
</pre></div>
</div>
<p>Lets see the HOS/CV splits</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">206</span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
<span class="linenos">207</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
<span class="linenos">208</span>     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos">209</span> <span class="n">df</span>
<span class="linenos">210</span>
<span class="linenos">211</span> <span class="c1"># Split in folds</span>
<span class="linenos">212</span> <span class="n">df</span> <span class="o">=</span> <span class="n">split_dataframe_cvs_folds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span>
<span class="linenos">213</span>     <span class="n">splitter</span><span class="o">=</span><span class="s1">&#39;skfold5&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bunch</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
<span class="linenos">214</span>     <span class="n">selected_rows</span><span class="o">=</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">sets</span> <span class="o">==</span> <span class="s1">&#39;cvs&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets
0                  5.1               3.5                1.4               0.2  hos
1                  4.9               3.0                1.4               0.2  cvs
2                  4.7               3.2                1.3               0.2  cvs
3                  4.6               3.1                1.5               0.2  cvs
4                  5.0               3.6                1.4               0.2  cvs
..                 ...               ...                ...               ...  ...
145                6.7               3.0                5.2               2.3  cvs
146                6.3               2.5                5.0               1.9  cvs
147                6.5               3.0                5.2               2.0  cvs
148                6.2               3.4                5.4               2.3  hos
149                5.9               3.0                5.1               1.8  hos

[150 rows x 5 columns]
</pre></div>
</div>
<p>Lets see the splits</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">219</span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
<span class="linenos">220</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
<span class="linenos">221</span>     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos">222</span> <span class="n">df</span>
<span class="linenos">223</span>
<span class="linenos">224</span> <span class="c1"># Divide in HOS and CSV.</span>
<span class="linenos">225</span> <span class="n">df</span> <span class="o">=</span> <span class="n">DataframeHOSCSVSplitter</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets split_0 split_1 split_2 split_3 split_4
0                  5.1               3.5                1.4               0.2  hos    None    None    None    None    None
1                  4.9               3.0                1.4               0.2  cvs   train   train   train   train    test
2                  4.7               3.2                1.3               0.2  cvs   train   train    test   train   train
3                  4.6               3.1                1.5               0.2  cvs   train   train    test   train   train
4                  5.0               3.6                1.4               0.2  cvs   train    test   train   train   train
..                 ...               ...                ...               ...  ...     ...     ...     ...     ...     ...
145                6.7               3.0                5.2               2.3  cvs   train   train   train   train    test
146                6.3               2.5                5.0               1.9  cvs   train   train   train   train    test
147                6.5               3.0                5.2               2.0  cvs   train   train   train   train    test
148                6.2               3.4                5.4               2.3  hos    None    None    None    None    None
149                5.9               3.0                5.1               1.8  hos    None    None    None    None    None

[150 rows x 10 columns]
</pre></div>
</div>
<p>Lets see the HOS/CSV sets</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">229</span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
<span class="linenos">230</span>     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
<span class="linenos">231</span>     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="linenos">232</span> <span class="n">df</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets split_0 split_1 split_2 split_3 split_4
0                  5.1               3.5                1.4               0.2  HOS    None    None    None    None    None
1                  4.9               3.0                1.4               0.2  CVS   train   train   train   train    test
2                  4.7               3.2                1.3               0.2  CVS   train   train    test   train   train
3                  4.6               3.1                1.5               0.2  HOS   train   train    test   train   train
4                  5.0               3.6                1.4               0.2  CVS   train    test   train   train   train
..                 ...               ...                ...               ...  ...     ...     ...     ...     ...     ...
145                6.7               3.0                5.2               2.3  HOS   train   train   train   train    test
146                6.3               2.5                5.0               1.9  HOS   train   train   train   train    test
147                6.5               3.0                5.2               2.0  CVS   train   train   train   train    test
148                6.2               3.4                5.4               2.3  CVS    None    None    None    None    None
149                5.9               3.0                5.1               1.8  CVS    None    None    None    None    None

[150 rows x 10 columns]
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sets</th>
      <th>split_0</th>
      <th>split_1</th>
      <th>split_2</th>
      <th>split_3</th>
      <th>split_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>HOS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>HOS</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>HOS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>HOS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>CVS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>CVS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>150 rows √ó 10 columns</p>
</div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.058 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-utils-plot-data-splitters-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/79e32b8f6389050f5d5d17c712e9838c/plot_data_splitters.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_data_splitters.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/7a203ba47855bc1418590d5412909690/plot_data_splitters.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_data_splitters.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_data_skfold_test.html" class="btn btn-neutral float-left" title="Test Skfold" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_data_wrapper.html" class="btn btn-neutral float-right" title="Data Wrapper" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Bernard Hernandez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>