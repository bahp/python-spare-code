

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Data splitters &mdash; python-spare-code 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dummy Data Wrapper" href="plot_data_wrapper.html" />
    <link rel="prev" title="Test Skfold" href="plot_data_skfold_test.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> python-spare-code
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Example Galleries</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">General</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#clean-damien-sepsis">clean-damien-sepsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#clean-therapy-mimic">clean-therapy-mimic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#explainer-dashboard">Explainer Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#factory-boy">Factory Boy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#jsonpickle">jsonpickle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#ldap">LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#matplotlib">Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#other">Other</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#pandas">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotly">Plotly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#scikits">Scikits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#screenshot-web">screenshot-web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#shap">Shap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tableone">TableOne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#threshold-moving">Threshold Moving</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tpot">TPOT</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#utils">Utils</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_data_skfold_test.html">Test Skfold</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Data splitters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_data_wrapper.html">Dummy Data Wrapper</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_favicons.html">Plot favicons</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_sklearn_iqr.html">IQRFilter</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">python-spare-code</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">General</a> &raquo;</li>
        
      <li>Data splitters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/_examples/utils/plot_data_splitters.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-utils-plot-data-splitters-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="data-splitters">
<span id="sphx-glr-examples-utils-plot-data-splitters-py"></span><h1>Data splitters<a class="headerlink" href="#data-splitters" title="Permalink to this headline">¶</a></h1>
<p>Useful methods to split data such as (i) hold out and
csv sets or (ii) cross validation folds.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not completed!</p>
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Libraries</span>
 <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
 <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

 <span class="c1"># Libraries specific</span>
 <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
 <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
 <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>


 <span class="k">def</span> <span class="nf">split_dataframe_hos_cvs</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
     <span class="sd">&quot;&quot;&quot;This method labels the dataframe hos and cvs sets.</span>

<span class="sd">     Parameters</span>
<span class="sd">     ----------</span>
<span class="sd">     dataframe: np.array or pd.DataFrame</span>
<span class="sd">         The data to be divided into HOS/CVS.</span>

<span class="sd">     Returns</span>
<span class="sd">     -------</span>
<span class="sd">     np.array:</span>
<span class="sd">         The outcome is a numpy array with rows labelled as</span>
<span class="sd">         cvs (cross-validation set) and hos (hold-out set).</span>
<span class="sd">         :param data:</span>
<span class="sd">         :param inplace:</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="c1"># Check it is a dataframe</span>
     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
         <span class="k">raise</span> <span class="ne">TypeError</span>

     <span class="c1"># Length</span>
     <span class="n">n</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

     <span class="c1"># Split in hos and training sets</span>
     <span class="n">cvs</span><span class="p">,</span> <span class="n">hos</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

     <span class="c1"># Create result</span>
     <span class="n">empty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
     <span class="n">empty</span><span class="p">[</span><span class="n">cvs</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cvs&#39;</span>
     <span class="n">empty</span><span class="p">[</span><span class="n">hos</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hos&#39;</span>

     <span class="c1"># Include</span>
     <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;sets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">empty</span>

     <span class="c1"># Return</span>
     <span class="k">return</span> <span class="n">dataframe</span>


 <span class="k">def</span> <span class="nf">split_dataframe_cvs_folds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span>
             <span class="n">selected_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
     <span class="sd">&quot;&quot;&quot;This method labels the different folds.</span>

<span class="sd">         .. note:</span>

<span class="sd">     Parameters</span>
<span class="sd">     ----------</span>
<span class="sd">     dataframe: np.array or pd.DataFrame</span>
<span class="sd">         The data to be divided into folds.</span>

<span class="sd">     splitter: str or splitter</span>
<span class="sd">         The splitter which can be an str or an splitter from the</span>
<span class="sd">         sklearn library which implementeds the method split.</span>

<span class="sd">     selected_rows: array of bools.</span>
<span class="sd">         The rows to be considered to create the folds. Note that if</span>
<span class="sd">         y is passed (for stratified cross validation) y will also be</span>
<span class="sd">         filtered by these rows.</span>

<span class="sd">     kwargs:</span>

<span class="sd">     Returns</span>
<span class="sd">     -------</span>
<span class="sd">     pd.DataFrame:</span>
<span class="sd">         The outcome is the same dataframe with an additional column</span>
<span class="sd">         &lt;set&gt; with the values cvs (cross-validation set) and hos</span>
<span class="sd">         (hold-out set).</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="c1"># Check it is a dataframe</span>
     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
         <span class="k">raise</span> <span class="ne">TypeError</span>

     <span class="c1"># Get splitter from string</span>
     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
         <span class="n">splitter</span> <span class="o">=</span> <span class="n">_DEFAULT_SPLITTERS</span><span class="p">[</span><span class="n">splitter</span><span class="p">]</span>

     <span class="c1"># Define X and y</span>
     <span class="c1">#X = dataframe[dataframe.sets == &#39;cvs&#39;].index.to_numpy()</span>
     <span class="c1">#y = dataframe[dataframe.sets == &#39;cvs&#39;][label]</span>

     <span class="c1"># Shape</span>
     <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span>

     <span class="c1"># No rows selected (all by default)</span>
     <span class="k">if</span> <span class="n">selected_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
         <span class="n">selected_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

     <span class="c1"># Select rows from y</span>
     <span class="k">if</span> <span class="s1">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
         <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">selected_rows</span><span class="p">]</span>

     <span class="c1"># Create indexes to use for splitting</span>
     <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="p">)[</span><span class="n">selected_rows</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

     <span class="c1"># Get splits of idxs</span>
     <span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

     <span class="c1"># Loop and add</span>
     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
         <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="n">train</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span>
         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="n">test</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s1">&#39;split_</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span>

     <span class="c1"># Return</span>
     <span class="k">return</span> <span class="n">dataframe</span>


 <span class="k">def</span> <span class="nf">split_dataframe_completeness</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
     <span class="k">pass</span>



 <span class="k">class</span> <span class="nc">DataframeHOSCSVSplitter</span><span class="p">():</span>
     <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="n">col_name</span> <span class="o">=</span> <span class="s1">&#39;sets&#39;</span>
     <span class="n">cvs_name</span> <span class="o">=</span> <span class="s1">&#39;CVS&#39;</span>
     <span class="n">hos_name</span> <span class="o">=</span> <span class="s1">&#39;HOS&#39;</span>

     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">cvs_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">hos_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
         <span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">         :param col_name:</span>
<span class="sd">         :param cvs_name:</span>
<span class="sd">         :param hos_name:</span>
<span class="sd">         &quot;&quot;&quot;</span>
         <span class="k">if</span> <span class="n">col_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span> <span class="o">=</span> <span class="n">col_name</span>
         <span class="k">if</span> <span class="n">cvs_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">cvs_name</span> <span class="o">=</span> <span class="n">cvs_name</span>
         <span class="k">if</span> <span class="n">hos_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">hos_name</span> <span class="o">=</span> <span class="n">hos_name</span>

     <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
         <span class="sd">&quot;&quot;&quot;Splits the dataframe...</span>
<span class="sd">         &quot;&quot;&quot;</span>
         <span class="c1"># Split</span>
         <span class="n">cvs</span><span class="p">,</span> <span class="n">hos</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

         <span class="c1"># Fill dataset</span>
         <span class="n">dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cvs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cvs_name</span>
         <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hos_name</span>

         <span class="c1"># Return</span>
         <span class="k">return</span> <span class="n">dataframe</span>



 <span class="c1"># Default splliters.</span>
 <span class="n">_DEFAULT_SPLITTERS</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;skfold10&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
     <span class="s1">&#39;skfold5&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
     <span class="s1">&#39;skfold2&#39;</span><span class="p">:</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
 <span class="p">}</span>

 <span class="n">TERMINAL</span> <span class="o">=</span> <span class="kc">True</span>

 <span class="c1"># --------------------------------------------------</span>
 <span class="c1"># Main</span>
 <span class="c1"># --------------------------------------------------</span>
 <span class="c1"># Libraries</span>
 <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

 <span class="c1"># Load data</span>
 <span class="n">bunch</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Dataframe</span>
 <span class="n">dataframe</span> <span class="o">=</span> <span class="n">bunch</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</td></tr></table></div>
<p>Lets see the dataset</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
 <span class="n">dataframe</span>

 <span class="c1"># Split in HOS and CVS sets</span>
 <span class="n">df</span> <span class="o">=</span> <span class="n">split_dataframe_hos_cvs</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)
0                  5.1               3.5                1.4               0.2
1                  4.9               3.0                1.4               0.2
2                  4.7               3.2                1.3               0.2
3                  4.6               3.1                1.5               0.2
4                  5.0               3.6                1.4               0.2
..                 ...               ...                ...               ...
145                6.7               3.0                5.2               2.3
146                6.3               2.5                5.0               1.9
147                6.5               3.0                5.2               2.0
148                6.2               3.4                5.4               2.3
149                5.9               3.0                5.1               1.8

[150 rows x 4 columns]
</pre></div>
</div>
<p>Lets see the HOS/CV splits</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
 <span class="n">df</span>

 <span class="c1"># Split in folds</span>
 <span class="n">df</span> <span class="o">=</span> <span class="n">split_dataframe_cvs_folds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span>
     <span class="n">splitter</span><span class="o">=</span><span class="s1">&#39;skfold5&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">bunch</span><span class="o">.</span><span class="n">target</span><span class="p">,</span>
     <span class="n">selected_rows</span><span class="o">=</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">sets</span> <span class="o">==</span> <span class="s1">&#39;cvs&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets
0                  5.1               3.5                1.4               0.2  cvs
1                  4.9               3.0                1.4               0.2  cvs
2                  4.7               3.2                1.3               0.2  hos
3                  4.6               3.1                1.5               0.2  hos
4                  5.0               3.6                1.4               0.2  cvs
..                 ...               ...                ...               ...  ...
145                6.7               3.0                5.2               2.3  hos
146                6.3               2.5                5.0               1.9  cvs
147                6.5               3.0                5.2               2.0  cvs
148                6.2               3.4                5.4               2.3  cvs
149                5.9               3.0                5.1               1.8  hos

[150 rows x 5 columns]
</pre></div>
</div>
<p>Lets see the splits</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
 <span class="n">df</span>

 <span class="c1"># Divide in HOS and CSV.</span>
 <span class="n">df</span> <span class="o">=</span> <span class="n">DataframeHOSCSVSplitter</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets split_0 split_1 split_2 split_3 split_4
0                  5.1               3.5                1.4               0.2  cvs   train   train   train   train    test
1                  4.9               3.0                1.4               0.2  cvs   train   train   train    test   train
2                  4.7               3.2                1.3               0.2  hos    None    None    None    None    None
3                  4.6               3.1                1.5               0.2  hos    None    None    None    None    None
4                  5.0               3.6                1.4               0.2  cvs   train   train   train    test   train
..                 ...               ...                ...               ...  ...     ...     ...     ...     ...     ...
145                6.7               3.0                5.2               2.3  hos    None    None    None    None    None
146                6.3               2.5                5.0               1.9  cvs    test   train   train   train   train
147                6.5               3.0                5.2               2.0  cvs    test   train   train   train   train
148                6.2               3.4                5.4               2.3  cvs   train   train    test   train   train
149                5.9               3.0                5.1               1.8  hos    None    None    None    None    None

[150 rows x 10 columns]
</pre></div>
</div>
<p>Lets see the HOS/CSV sets</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="k">if</span> <span class="n">TERMINAL</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data&quot;</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
 <span class="n">df</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm) sets split_0 split_1 split_2 split_3 split_4
0                  5.1               3.5                1.4               0.2  CVS   train   train   train   train    test
1                  4.9               3.0                1.4               0.2  CVS   train   train   train    test   train
2                  4.7               3.2                1.3               0.2  HOS    None    None    None    None    None
3                  4.6               3.1                1.5               0.2  HOS    None    None    None    None    None
4                  5.0               3.6                1.4               0.2  CVS   train   train   train    test   train
..                 ...               ...                ...               ...  ...     ...     ...     ...     ...     ...
145                6.7               3.0                5.2               2.3  CVS    None    None    None    None    None
146                6.3               2.5                5.0               1.9  CVS    test   train   train   train   train
147                6.5               3.0                5.2               2.0  CVS    test   train   train   train   train
148                6.2               3.4                5.4               2.3  CVS   train   train    test   train   train
149                5.9               3.0                5.1               1.8  HOS    None    None    None    None    None

[150 rows x 10 columns]
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>sets</th>
      <th>split_0</th>
      <th>split_1</th>
      <th>split_2</th>
      <th>split_3</th>
      <th>split_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>HOS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>HOS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>CVS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>CVS</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>CVS</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>CVS</td>
      <td>train</td>
      <td>train</td>
      <td>test</td>
      <td>train</td>
      <td>train</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>HOS</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 10 columns</p>
</div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.068 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-utils-plot-data-splitters-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/48c83d3ca0bbdaadadbee5621ef38bc8/plot_data_splitters.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_data_splitters.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8bcea07bd15f8881d95820066535e22e/plot_data_splitters.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_data_splitters.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="plot_data_wrapper.html" class="btn btn-neutral float-right" title="Dummy Data Wrapper" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="plot_data_skfold_test.html" class="btn btn-neutral float-left" title="Test Skfold" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021-2023, Bernard Hernandez.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>